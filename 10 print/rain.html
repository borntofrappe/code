<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>10 print</title>
    <style>
      body {
        overflow: hidden;
        margin: 0;
        background-image: linear-gradient(
          to bottom right,
          hsl(215, 90%, 57%),
          hsl(215, 80%, 60%)
        );
      }

      div {
        position: absolute;
        bottom: 1rem;
        left: 50%;
        transform: translate(-50%, 0);
        padding: 0.75rem 1.75rem;
        color: hsl(215, 80%, 95%);
        background: hsl(215, 90%, 8%);
        box-shadow: 0 0.1rem 0.75rem -0.1rem hsl(215, 90%, 0%);
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      svg {
        width: 2.5rem;
      }
    </style>
  </head>
  <body>
    <div>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="icon icon-tabler icon-tabler-cloud-snow"
        width="44"
        height="44"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        fill="none"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
        <path
          d="M7 18a4.6 4.4 0 0 1 0 -9a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7"
        />
        <path d="M11 15v.01m0 3v.01m0 3v.01m4 -4v.01m0 3v.01" />
      </svg>
      <input
        aria-label="Rain intensity"
        min="0"
        max="100"
        value="50"
        type="range"
        id="range"
        name="range"
      />
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="icon icon-tabler icon-tabler-cloud-rain"
        width="44"
        height="44"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        fill="none"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
        <path
          d="M7 18a4.6 4.4 0 0 1 0 -9a5 4.5 0 0 1 11 2h1a3.5 3.5 0 0 1 0 7"
        />
        <path d="M11 13v2m0 3v2m4 -5v2m0 3v2" />
      </svg>
    </div>
    <canvas width="400" height="400"></canvas>
    <script>
      const canvas = document.querySelector('canvas');
      const input = document.querySelector('input[type="range"]');

      let { innerHeight: height, innerWidth: width } = window;
      canvas.width = width;
      canvas.height = height;

      const context = canvas.getContext('2d');

      const maxColor = 100;
      let spacing = 20;
      let drawTime;
      let drawInterval = 60;
      let lineWidth = 0.2;
      let threshold = 0.8;

      const odds = () => Math.random() > threshold;

      function resize() {
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;
      }

      function draw() {
        context.clearRect(0, 0, width, height);
        context.lineWidth = lineWidth;
        for (let x = 0; x < width; x += spacing) {
          for (let y = 0; y < height; y += spacing) {
            const color =
              Math.min(Math.ceil((maxColor / 2 / width) * x), maxColor / 2) +
              Math.min(Math.ceil((maxColor / 2 / height) * y), maxColor / 2);
            context.strokeStyle = `rgb(${color / 4}, ${color / 2}, ${color})`;
            if (odds()) {
              context.beginPath();
              context.moveTo(x, y);
              context.lineTo(x + spacing, y + spacing);
              context.closePath();
              context.stroke();
            }
          }
        }
      }

      window.addEventListener('resize', () => {
        resize();
      });

      function animate(timestamp) {
        if (!drawTime) {
          drawTime = timestamp;
        } else {
          const elapsedTime = timestamp - drawTime;
          if (elapsedTime > drawInterval) {
            draw();
            drawTime = null;
          }
        }

        window.requestAnimationFrame(animate);
      }

      animate();

      const map = ({ value, min, max, minRange, maxRange }) =>
        minRange + (maxRange - minRange) * (value / (max - min));

      input.addEventListener('input', (e) => {
        const { value, min, max } = e.target;
        spacing = map({ value, min, max, minRange: 25, maxRange: 10 });
        drawInterval = map({ value, min, max, minRange: 100, maxRange: 40 });
        lineWidth = map({ value, min, max, minRange: 0.1, maxRange: 0.4 });
        threshold = map({ value, min, max, minRange: 0.95, maxRange: 0.65 });
      });
    </script>
  </body>
</html>
